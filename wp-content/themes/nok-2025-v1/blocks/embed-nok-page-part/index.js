(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,n=window.wp.components,i=window.ReactJSXRuntime,r=window.wp.primitives;var o=(0,i.jsx)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(r.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})});const s=window.wp.data,a=window.wp.i18n,l=window.wp.element,d=({value:e,onChange:t,icons:n})=>{const[r,o]=(0,l.useState)(!1),[s,a]=(0,l.useState)(""),d=Object.entries(n).flatMap(e=>Object.entries(e[1]).map(t=>({name:t[0],svg:t[1],category:e[0]}))),c=d.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())),p=d.find(t=>t.name===e);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("style",{children:"\n        svg.nok-icon {\n            width: 100%;\n            height: 100%;\n            display: block;\n        }\n    "}),(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"8px"},children:"Icon"}),(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsx)("div",{onClick:()=>o(!r),style:{border:"1px solid #ddd",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",background:"#fff",minHeight:"40px"},children:p?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{width:"24px",height:"24px",flexShrink:0},dangerouslySetInnerHTML:{__html:p.svg}}),(0,i.jsx)("span",{style:{fontSize:"13px"},children:p.name})]}):(0,i.jsx)("span",{style:{fontSize:"13px",color:"#757575"},children:"Select an icon..."})}),p&&(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),t("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"#d63638",color:"#fff",border:"none",borderRadius:"3px",padding:"4px 8px",fontSize:"11px",cursor:"pointer",fontWeight:"500"},title:"Clear icon",children:"Ã—"})]}),r&&(0,i.jsxs)("div",{style:{position:"absolute",zIndex:9999,background:"#fff",border:"1px solid #ddd",borderRadius:"4px",marginTop:"4px",maxHeight:"400px",width:"300px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",overflow:"hidden"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Search icons...",value:s,onChange:e=>a(e.target.value),style:{width:"100%",padding:"8px",border:"none",borderBottom:"1px solid #ddd",fontSize:"13px",outline:"none"}}),(0,i.jsx)("div",{style:{overflowY:"auto",maxHeight:"350px",padding:"8px"},children:0===c.length?(0,i.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#757575",fontSize:"13px"},children:"No icons found"}):(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},children:c.map(n=>(0,i.jsx)("div",{onClick:()=>{t(n.name),o(!1),a("")},title:n.name,style:{padding:"2px",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",background:e===n.name?"#e0f0ff":"#fff",transition:"all 0.15s",aspectRatio:"1"},onMouseEnter:t=>{e!==n.name&&(t.currentTarget.style.background="#f5f5f5")},onMouseLeave:t=>{e!==n.name&&(t.currentTarget.style.background="#fff")},children:(0,i.jsx)("div",{style:{width:"3em",height:"3em"},dangerouslySetInnerHTML:{__html:n.svg}})},n.name))})})]})]})]})},c={degsteps:60,startsat:100,startbri:100,startdeg:0,gradsteps:10,paletlim:[0,360]},p=new class{constructor(e,t,n,i,r,o){this.startdeg=null!=i?i:c.startdeg,this.degsteps=null!=e?e:c.degsteps,this.startsat=null!=t?t:c.startsat,this.startbri=null!=n?n:c.startbri,this.gradsteps=r&&r>1?r:c.gradsteps,this.paletlim=null!=o?o:c.paletlim,this.calls=0,this.color=null,this.deg=0,this.cyc=0,this.bri=100,this.sat=100,this.opa=1}new(e,t){return this.color=this._generateColor(e,t),this.string=this.color.string,this.values=this.color.values,this.contra=this.color.contra,this.hex=this._rgbToHex(this.color.values),this.calls++,this}adjust(e){var t,n,i,r;const o=null!==(t=e.deg)&&void 0!==t?t:0,s=null!==(n=e.sat)&&void 0!==n?n:this.sat,a=null!==(i=e.bri)&&void 0!==i?i:this.bri,l=null!==(r=e.opa)&&void 0!==r?r:this.opa,d=(this.deg+o)%this.paletlim[1],c=this._clamp(a<=1&&a>0?this.bri*a:a,0,100),p=this._clamp(s<=1&&s>0?this.sat*s:s,0,100),h=this._clamp(l,0,1);return this._hsvToRgb(d,p,c,h)}_generateColor(e,t){let n=!1;if("string"==typeof e)if("#"===e[0]){const t=this._hslToHsv(this._hexToHsl(e));this.deg=t[0],this.sat=t[1],this.bri=t[2],n=!0}else this.deg=this._stringToDegrees(e);else this.startdeg=Math.max(this.startdeg,this.paletlim[0]),this.deg=this.startdeg+this.calls*this.degsteps;if(this.cyc=Math.floor(this.deg/this.paletlim[1]),!n&&(this.bri=e&&e>0?e:this.startbri,this.sat=t&&t>0?t:this.startsat,this.bri=Math.abs(this.bri%101),this.sat=Math.abs(this.sat%101),this.deg=this.deg%(this.paletlim[1]+1),this.deg=Math.max(this.deg,this.paletlim[0]),this.paletlim[0]%this.degsteps===0&&this.cyc>0)){const t=this.cyc*this.gradsteps;this.bri=e&&e>0?e:this.startbri-t,t>=100&&(this.cyc=0,this.gradsteps=this.gradsteps/2)}return this._hsvToRgb(this.deg,this.sat,this.bri)}_stringToDegrees(e){const t=[...e].reduce((e,t)=>t.charCodeAt(0)+((e<<5)-e),0);return Math.abs(t)%360}_hsvToRgb(e,t,n,i){e/=360,t/=100,n/=100,i=void 0!==i?parseFloat(i):void 0;const r=Math.floor(6*e),o=6*e-r,s=n*(1-t),a=n*(1-o*t),l=n*(1-(1-o)*t);let d,c,p;switch(r%6){case 0:d=n,c=l,p=s;break;case 1:d=a,c=n,p=s;break;case 2:d=s,c=n,p=l;break;case 3:d=s,c=a,p=n;break;case 4:d=l,c=s,p=n;break;case 5:d=n,c=s,p=a}const h=[Math.round(255*d),Math.round(255*c),Math.round(255*p)],g=void 0!==i?"rgba":"rgb";return void 0!==i&&h.push(i),{values:h,string:`${g}(${h.join(",")})`,hex:this._rgbToHex(h),contra:this._textContrast(h)}}_hexToHsl(e){const t=this._hexToRgb(e),n=t[0]/255,i=t[1]/255,r=t[2]/255,o=Math.min(n,i,r),s=Math.max(n,i,r),a=s-o;let l=0;0!==a&&(l=s===n?(i-r)/a%6:s===i?(r-n)/a+2:(n-i)/a+4),l=Math.round(60*l),l<0&&(l+=360);const d=(s+o)/2;return[l,+(100*(0===a?0:a/(1-Math.abs(2*d-1)))).toFixed(1),+(100*d).toFixed(1)]}_hslToHsv(e){const t=e[1]*(e[2]<50?e[2]:100-e[2])/100,n=0===t?0:2*t/(e[2]+t)*100,i=e[2]+t;return[e[0],n,i]}_hexToRgb(e){return e.match(/\w\w/g).map(e=>+`0x${e}`)}_rgbToHex(e){return"#"+e.slice(0,3).map(e=>e.toString(16).padStart(2,"0")).join("")}_textContrast(e){return Math.round((299*parseInt(e[0])+587*parseInt(e[1])+114*parseInt(e[2]))/1e3)>125?"rgb(0,0,0)":"rgb(255,255,255)"}_clamp(e,t,n){return Math.min(Math.max(e,t),n)}},h="nok-2025-v1",g=({value:e,options:t,onChange:r,onOpen:o})=>{const[s,a]=(0,l.useState)(!1),[d,c]=(0,l.useState)(null),[h,g]=(0,l.useState)(""),u=(0,l.useRef)(),x=(0,l.useRef)(),b=t.find(t=>t.value===e);(0,l.useEffect)(()=>{s&&x.current&&setTimeout(()=>x.current?.focus(),50)},[s]);const m=(e,t)=>{if(!t)return{matches:!0,score:0,indices:[]};const n=e.toLowerCase(),i=t.toLowerCase();let r=0,o=0;const s=[];let a=0;for(;r<i.length&&o<n.length;)i[r]===n[o]&&(s.push(o),a+=100-o,r++),o++;return{matches:r===i.length,score:a,indices:s}},f=h?t.map(e=>{const t=m(e.label.replace(/<[^>]*>/g,""),h),n=m(e.template||"",h),i=t.score>n.score?t:n;return{...e,matchData:i,searchScore:i.score}}).filter(e=>e.matchData.matches).sort((e,t)=>t.searchScore-e.searchScore):t.filter(e=>0!==e.value);return(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsxs)(n.Button,{ref:u,variant:"secondary",onClick:()=>{const e=!s;a(e),g(""),e&&o&&o()},style:{width:"100%",textAlign:"left",padding:"8px 12px",borderBottom:"1px solid #f0f0f1",borderRadius:"0",justifyContent:"end",color:"inherit"},children:[(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:b?.label||"Select Page Part..."},style:{flexBasis:"100%"}}),b?(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:`${b.template}`},style:{padding:"2px 6px",backgroundColor:p.new(b.template).string,borderRadius:"6px",fontSize:"1em",color:p.new(b.template).contra,marginLeft:"auto"}}):null]}),s&&(0,i.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:99999},children:[(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"transparent"},onClick:()=>a(!1)}),(0,i.jsxs)("div",{style:{position:"absolute",top:u.current?.getBoundingClientRect().bottom+window.scrollY,left:u.current?.getBoundingClientRect().left+window.scrollX,width:u.current?.offsetWidth||"auto",maxHeight:"400px",backgroundColor:"white",border:"1px solid #ccc",borderRadius:"2px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)",zIndex:1e5,display:"flex",flexDirection:"column"},children:[(0,i.jsx)("div",{style:{padding:"8px",borderBottom:"1px solid #ddd",position:"sticky",top:0,backgroundColor:"white",zIndex:1},children:(0,i.jsx)("input",{ref:x,type:"text",placeholder:"Zoek page part...",value:h,onChange:e=>g(e.target.value),onKeyDown:e=>{"Escape"===e.key?a(!1):"Enter"===e.key&&f.length>0&&(r(f[0].value),a(!1))},style:{width:"100%",padding:"6px 8px",border:"1px solid #ccc",borderRadius:"3px",fontSize:"13px",outline:"none"}})}),(0,i.jsx)("div",{style:{overflowY:"auto",maxHeight:"300px"},children:0===f.length?(0,i.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#666",fontSize:"13px"},children:"Geen resultaten gevonden"}):f.map(t=>{const o=p.new(t.template),s=m(t.label.replace(/<[^>]*>/g,""),h),l=h?((e,t)=>{if(!t||0===t.length)return e;const n=e.replace(/<[^>]*>/g,"");let i="",r=0;return t.forEach(e=>{i+=n.slice(r,e),i+=`<mark style="background: #ffd700; padding: 0; font-weight: bold;">${n[e]}</mark>`,r=e+1}),i+=n.slice(r),i})(t.label,s.indices):t.label;return(0,i.jsxs)(n.Button,{onClick:()=>{r(t.value),a(!1)},onMouseEnter:()=>c(t.value),onMouseLeave:()=>c(null),style:{width:"100%",textAlign:"left",padding:"8px 12px",border:"none",borderBottom:"1px solid #f0f0f1",borderRadius:"0",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",justifyContent:"space-between",backgroundColor:t.value===e?"var(--wp-admin-theme-color)":d===t.value?"#e6f3ff":"transparent",color:t.value===e?"white":"inherit"},children:[(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:l}}),t.value?(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:`${t.template}`},style:{padding:"2px 6px",backgroundColor:o.adjust({sat:.7}).string,borderRadius:"6px",fontSize:"1em",color:o.contra}}):null]},t.value)})})]})]})]})};(0,e.registerBlockType)("nok2025/embed-nok-page-part",{attributes:{postId:{type:"number",default:0},overrides:{type:"object",default:{}},excludeFromSeo:{type:"boolean",default:!1}},edit:({attributes:e,setAttributes:r})=>{const{postId:c,overrides:p,excludeFromSeo:u}=e,{invalidateResolution:x}=(0,s.useDispatch)("core"),b=(0,s.useSelect)(e=>e("core").getEntityRecords("postType","page_part",{per_page:-1,_embed:!0,orderby:"modified",order:"desc"}),[])||[],m="undefined"!=typeof window&&window.PagePartDesignSettings&&window.PagePartDesignSettings.registry||{},f=b.find(e=>e.id===c),v=f?.title?.rendered||"",y=m[f?.meta?.design_slug||""]||{},_=(y.custom_fields||[]).filter(e=>e.page_editable),w=(0,s.useSelect)(e=>{const t=p._override_thumbnail_id;return t?e("core").getMedia(t):null},[p._override_thumbnail_id]),j=[{label:(0,a.__)(" - Selecteer Page Part blokâ€¦ - ",h),value:0},...b.map(e=>{const t=e.meta&&e.meta.design_slug||"",n=m[t]&&m[t].name?m[t].name:t||"Unknown";return{label:`${e.title.rendered}`,template:n,value:e.id}})],k=c?`/wp-json/nok-2025-v1/v1/embed-page-part/${c}?${new URLSearchParams(Object.entries(p).map(([e,t])=>[e,t])).toString()}`:"",S=(0,l.useRef)(null),[C,P]=(0,l.useState)(400);return(0,l.useEffect)(()=>{const e=S.current;if(!e)return;let t;const n=()=>{try{const t=e.contentDocument||e.contentWindow.document,n=Math.max(t.documentElement.scrollHeight,t.body.scrollHeight);P(n)}catch(e){}},i=()=>{n();try{const t=(e.contentDocument||e.contentWindow.document).querySelector('meta[name="yoast-content"]');if(t&&c){const e=t.getAttribute("content");window.nokPagePartData=window.nokPagePartData||{},window.nokPagePartData[c]=e,window.nokYoastIntegration?.debug&&console.log(`[Yoast] Stored content for part ${c}:`,e.length,"chars")}}catch(e){}e.contentDocument&&e.contentDocument.body&&(t=new MutationObserver(n),t.observe(e.contentDocument.body,{childList:!0,subtree:!0,attributes:!0}))};return e.addEventListener("load",i),()=>{e.removeEventListener("load",i),t&&t.disconnect()}},[c]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.BlockControls,{}),(0,i.jsxs)("div",{...(0,t.useBlockProps)(),style:{position:"relative",width:"100%",marginBottom:"15px",maxWidth:"100%",padding:"15px 3vw",boxSizing:"border-box"},children:[u&&(0,i.jsx)("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#f0f0f1",padding:"4px 8px",borderRadius:"3px",fontSize:"11px",color:"#666",zIndex:10,border:"1px solid #ddd"},children:"ðŸš« SEO uitgesloten"}),(0,i.jsxs)(n.PanelBody,{title:(0,a.__)("NOK Page Part Blok",h)+(v?` - ${v}`:""),initialOpen:!0,children:[(0,i.jsx)(g,{label:(0,a.__)("Selecteer een Page Part uit de lijst",h),value:c,options:j,onChange:e=>r({postId:parseInt(e,10)}),onOpen:()=>{x("getEntityRecords",["postType","page_part",{per_page:-1,_embed:!0,orderby:"modified",order:"desc"}])}}),0!==c&&(0,i.jsx)(n.PanelBody,{title:(0,a.__)("SEO Instellingen",h),initialOpen:!1,children:(0,i.jsx)(n.CheckboxControl,{label:(0,a.__)("Meenemen in SEO analyse",h),help:(0,a.__)("Schakel uit om deze page part uit te sluiten van Yoast SEO analyse",h),checked:!u,onChange:e=>{r({excludeFromSeo:!e}),window.nokYoastIntegration?.debug&&console.log(`[Yoast] Part ${c} SEO exclusion changed to:`,!e)}})}),_.length>0&&0!==c&&(0,i.jsxs)(n.PanelBody,{title:(0,a.__)("Pagina-afhankelijke overrides",h),initialOpen:!1,children:[(0,i.jsx)("p",{style:{fontSize:"12px",color:"#666",marginBottom:"12px"},children:"Deze page part biedt de mogelijkheid om enkele instellingen specifek voor deze pagina te overschrijven/herdefinieren:"}),(0,i.jsx)(n.TextControl,{label:(0,a.__)("Alternatieve titel",h),value:p._override_title||"",onChange:e=>{const t={...p};""===e?delete t._override_title:t._override_title=e,r({overrides:t})},placeholder:"â€” Gebruik originele titel â€”"}),(0,i.jsx)(n.TextareaControl,{label:(0,a.__)("Alternatieve inhoud",h),value:p._override_content||"",onChange:e=>{const t={...p};""===e?delete t._override_content:t._override_content=e,r({overrides:t})},placeholder:"â€” Gebruik originele inhoud â€”",rows:4}),_.map(e=>{const t=p[e.meta_key]||"",o=t=>{const n={...p};""===t||null===t?delete n[e.meta_key]:n[e.meta_key]=t,r({overrides:n})};switch(e.type){case"icon-selector":const r=window.PagePartDesignSettings?.icons||{};return(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,i.jsxs)("label",{style:{display:"block",fontSize:"11px",fontWeight:"600",marginBottom:"4px",color:"#666"},children:["Override ",e.label]}),t&&(0,i.jsx)("button",{onClick:()=>o(""),style:{fontSize:"11px",color:"#d63638",background:"none",border:"none",padding:"0",marginBottom:"8px",cursor:"pointer",textDecoration:"underline"},children:"Clear override (gebruik de ingestelde waarde)"}),(0,i.jsx)(d,{value:t,icons:r,onChange:o})]},e.meta_key);case"select":const s=e.options||[],a=e.option_labels||s;return(0,i.jsx)(n.SelectControl,{label:`Override ${e.label}`,value:t,options:[{label:"â€” Gebruik de ingestelde waarde â€”",value:""},...s.map((e,t)=>({label:a[t]||e,value:e}))],onChange:o},e.meta_key);case"checkbox":return(0,i.jsx)(n.SelectControl,{label:`Override ${e.label}`,value:t,options:[{label:"â€” Gebruik de ingestelde waarde â€”",value:""},{label:"Ja",value:"1"},{label:"Nee",value:"0"}],onChange:o},e.meta_key);case"text":case"url":return(0,i.jsx)(n.TextControl,{label:`Override ${e.label}`,value:t,onChange:o,placeholder:"â€” Gebruik de ingestelde waarde â€”"},e.meta_key);default:return null}})]}),0!==c&&y.featured_image_overridable&&(0,i.jsxs)(n.PanelBody,{title:(0,a.__)("Uitgelichte afbeelding",h),initialOpen:!1,children:[(0,i.jsx)("p",{style:{fontSize:"12px",color:"#666",marginBottom:"12px"},children:"Overschrijf de uitgelichte afbeelding van deze page part specifiek voor deze pagina."}),(0,i.jsx)(t.MediaUploadCheck,{children:(0,i.jsx)(t.MediaUpload,{onSelect:e=>{const t={...p};t._override_thumbnail_id=e.id,r({overrides:t})},allowedTypes:["image"],value:p._override_thumbnail_id||"",render:({open:e})=>(0,i.jsxs)("div",{children:[w&&(0,i.jsx)("div",{style:{marginBottom:"12px",border:"1px solid #ddd",borderRadius:"4px",overflow:"hidden",maxWidth:"200px"},children:(0,i.jsx)("img",{src:w.media_details?.sizes?.medium?.source_url||w.media_details?.sizes?.thumbnail?.source_url||w.source_url,style:{width:"100%",height:"auto",display:"block"},alt:""})}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(0,i.jsx)(n.Button,{variant:"secondary",onClick:e,children:w?(0,a.__)("Wijzig afbeelding",h):(0,a.__)("Selecteer afbeelding",h)}),w&&(0,i.jsx)(n.Button,{variant:"tertiary",isDestructive:!0,onClick:()=>{const e={...p};delete e._override_thumbnail_id,r({overrides:e})},children:(0,a.__)("Verwijder override",h)})]})]})})})]}),0===c?(0,i.jsx)("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f0f0f1",border:"1px dashed #ccc"},children:(0,i.jsx)("p",{style:{margin:0,color:"#666"},children:(0,a.__)("Selecteer een Page Part om de preview te zien",h)})}):(0,i.jsxs)("div",{style:{marginTop:"15px",border:"1px solid rgba(0,0,0,0.6)",borderRadius:"10px",padding:"0",boxSizing:"border-box",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,i.jsxs)("div",{style:{background:"rgba(0,0,0,0.1)",borderBottom:"1px solid rgba(0,0,0,0.6)",padding:"8px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,i.jsx)("strong",{children:"Preview:"}),(0,i.jsx)("span",{children:f?.title.rendered||`ID ${c}`}),(0,i.jsx)("a",{href:`/wp-admin/post.php?post=${c}&action=edit`,target:"_blank",title:" Bewerk deze Page Part (in nieuw tabblad)",rel:"noopener noreferrer",style:{color:"#8cf",textDecoration:"none",marginLeft:"auto"},children:(0,i.jsx)(n.Icon,{icon:o})})]}),(0,i.jsx)("iframe",{ref:S,src:k,style:{width:"100%",height:`${C}px`,flexShrink:0}})]})]})]})]})},save:()=>null})})();