(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,o=window.wp.components,n=window.wp.data,i=window.wp.i18n,s=window.wp.element,l=window.ReactJSXRuntime,r="nok-2025-v1";(0,e.registerBlockType)("nok2025/embed-nok-page-part",{edit:({attributes:e,setAttributes:a})=>{const{postId:d}=e,c=(0,n.useSelect)(e=>e("core").getEntityRecords("postType","page_part",{per_page:-1}),[])||[],p=d?`/wp-json/nok-2025-v1/v1/embed-page-part/${d}`:"",w=(0,s.useRef)(null),[u,b]=(0,s.useState)(400);return(0,s.useEffect)(()=>{const e=w.current;if(!e)return;let t;const o=()=>{try{const t=e.contentDocument||e.contentWindow.document,o=Math.max(t.documentElement.scrollHeight,t.body.scrollHeight);b(o)}catch(e){}},n=()=>{o(),t=new MutationObserver(o),t.observe(e.contentDocument.body,{childList:!0,subtree:!0,attributes:!0})};return e.addEventListener("load",n),()=>{e.removeEventListener("load",n),t&&t.disconnect()}},[d]),(0,t.useBlockProps)({style:{position:"relative",width:"100%",margin:0,maxWidth:"100%"}}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.BlockControls,{}),(0,l.jsxs)("div",{...(0,t.useBlockProps)(),style:{position:"relative",width:"100%",margin:"0",maxWidth:"100%"},children:[(0,l.jsx)(o.PanelBody,{title:(0,i.__)("NOK Page Part Blok",r),initialOpen:!0,children:(0,l.jsx)(o.SelectControl,{label:(0,i.__)("Selecteer een Page Part uit de lijst",r),value:d,options:[{label:(0,i.__)(" - Selecteer Page Part blok… - ",r),value:0},...c.map(e=>({label:e.title.rendered,value:e.id}))],onChange:e=>a({postId:parseInt(e,10)})})}),d?(0,l.jsx)("div",{style:{position:"relative",width:"100%"},children:(0,l.jsx)("iframe",{ref:w,title:(0,i.__)("Embedded NOK Page Part",r),src:p,style:{width:"100%",height:`${u}px`,border:0},sandbox:"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"})}):(0,l.jsx)("p",{children:(0,i.__)("Selecteer een blok om te bekijken…",r)})]})]})},save:()=>null})})();