export const NAME="videoPlayback";let youtubeReady=false;let youtubeQueue=[];function initYouTube(){if(window.YT&&window.YT.Player){youtubeReady=true;youtubeQueue.forEach(fn=>fn());youtubeQueue=[];return}if(!document.querySelector('script[src*="youtube.com/iframe_api"]')){const tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";document.head.appendChild(tag)}window.onYouTubeIframeAPIReady=()=>{youtubeReady=true;youtubeQueue.forEach(fn=>fn());youtubeQueue=[]}}function setupYouTubePlayer(iframe,
wrapper){const setup=()=>{try{const player=new window.YT.Player(iframe,{events:{onStateChange:event=>{if(event.data===1)wrapper.classList.add("is-playing");else wrapper.classList.remove("is-playing")}}})}catch(e){console.error("Error setting up YouTube player:",e)}};if(youtubeReady)setup();else{youtubeQueue.push(setup);initYouTube()}}let vimeoReady=false;function initVimeo(){return new Promise(resolve=>{if(window.Vimeo&&window.Vimeo.Player){vimeoReady=true;resolve();return}if(!document.querySelector('script[src*="player.vimeo.com/api/player.js"]')){const script=
document.createElement("script");script.src="https://player.vimeo.com/api/player.js";script.onload=()=>{vimeoReady=true;resolve()};document.head.appendChild(script)}})}async function setupVimeoPlayer(iframe,wrapper){await initVimeo();try{const player=new window.Vimeo.Player(iframe);player.on("play",()=>{wrapper.classList.add("is-playing")});player.on("pause",()=>{wrapper.classList.remove("is-playing")});player.on("ended",()=>{wrapper.classList.remove("is-playing")})}catch(e){console.error("Error setting up Vimeo player:",
e)}}export function init(elements){if(!Array.isArray(elements))return;elements.forEach(element=>{if(!(element instanceof Element))return;const videoWrappers=element.querySelectorAll(".nok-video-block__video-wrapper");videoWrappers.forEach(wrapper=>{const video=wrapper.querySelector("video");if(video){video.addEventListener("play",()=>wrapper.classList.add("is-playing"));video.addEventListener("pause",()=>wrapper.classList.remove("is-playing"));video.addEventListener("ended",()=>wrapper.classList.remove("is-playing"));
return}const iframe=wrapper.querySelector("iframe");if(!iframe)return;const src=iframe.src||"";if(src.includes("youtube.com")||src.includes("youtu.be")){if(!src.includes("enablejsapi=1")){const separator=src.includes("?")?"&":"?";iframe.src=src+separator+"enablejsapi=1"}setupYouTubePlayer(iframe,wrapper)}else if(src.includes("vimeo.com"))setupVimeoPlayer(iframe,wrapper)})})}export function cleanup(elements){}export function destroy(){youtubeQueue=[]};
