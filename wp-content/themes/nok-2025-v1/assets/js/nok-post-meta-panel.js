(()=>{"use strict";const e=window.wp.plugins,t=window.wp.editor,n=window.wp.components,o=window.wp.data,s=window.wp.element,i=window.ReactJSXRuntime,l={margin:"8px 0 8px 0",fontSize:"12px",color:"#757575",fontStyle:"italic",lineHeight:"1.4"},r=({label:e,children:t})=>(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[e&&(0,i.jsx)("div",{style:{marginBottom:"8px",fontSize:"11px",fontWeight:"600",textTransform:"uppercase",color:"#1e1e1e"},children:e}),t]});(0,e.registerPlugin)("nok-post-meta-panel",{render:()=>{const{editPost:e}=(0,o.useDispatch)("core/editor"),{meta:a,postType:d,categories:c,taxonomyTerms:p,vestigingenPosts:x}=(0,o.useSelect)(e=>{const t=e("core/editor"),n=e("core").getEntityRecords("postType","vestiging",{per_page:-1,status:"publish",orderby:"title",order:"asc"})||[];return{meta:t.getEditedPostAttribute("meta")||{},postType:t.getCurrentPostType(),categories:t.getEditedPostAttribute("categories")||[],taxonomyTerms:t.getEditedPostAttribute("terms")||{},vestigingenPosts:n}}),g=window.nokPostMetaFields?.fields||{},h=(0,s.useMemo)(()=>{const e={};return Object.entries(g).forEach(([t,n])=>{let o=!0;if(n.categories&&n.categories.length>0){const e=n.categories.some(e=>c.includes(e));o=o&&e}n.taxonomies&&Object.keys(n.taxonomies).length>0&&Object.entries(n.taxonomies).forEach(([e,t])=>{if(t.length>0){const n=p[e]||[],s=t.some(e=>n.includes(e));o=o&&s}}),o&&(e[t]=n)}),e},[g,c,p]);if(0===Object.keys(h).length)return null;const m=(t,n)=>{e({meta:{...a,[t]:n}})};return(0,i.jsx)(t.PluginDocumentSettingPanel,{name:"nok-post-meta",title:"NOK Extra instellingen",icon:"admin-generic",children:Object.entries(h).map(([e,t])=>((e,t)=>{var o,s;const d=null!==(o=null!==(s=a[e])&&void 0!==s?s:t.default)&&void 0!==o?o:"",c={value:d,onChange:t=>m(e,t)};switch(t.type){case"textarea":return(0,i.jsxs)(r,{label:t.label,children:[(0,i.jsx)(n.TextareaControl,{...c,placeholder:t.placeholder,rows:3}),t.description&&(0,i.jsx)("p",{style:l,children:t.description})]},t.meta_key);case"url":return(0,i.jsxs)(r,{label:t.label,children:[(0,i.jsx)(n.TextControl,{...c,type:"url",placeholder:t.placeholder||"https://...",__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),t.description&&(0,i.jsx)("p",{style:l,children:t.description})]},t.meta_key);case"checkbox":return(0,i.jsx)(r,{children:(0,i.jsx)(n.CheckboxControl,{label:t.label,help:t.description||"",checked:"1"===d||1===d||!0===d,onChange:t=>m(e,t?"1":"0")})},t.meta_key);case"post_select":const o="vestiging"===(t.post_type||"vestiging")?x:[],s=[{label:t.placeholder||"Selecteer...",value:""},...o.map(e=>({label:e.title?.rendered||`Post #${e.id}`,value:e.id.toString()}))];return(0,i.jsxs)(r,{label:t.label,children:[(0,i.jsx)(n.SelectControl,{value:d?d.toString():"",options:s,onChange:t=>m(e,t?parseInt(t):""),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),t.description&&(0,i.jsx)("p",{style:l,children:t.description})]},t.meta_key);case"opening_hours":const a=(e=>{if(!e)return{};if("object"==typeof e)return e;try{return JSON.parse(e)}catch(e){return{}}})(d),p=["monday","tuesday","wednesday","thursday","friday"],g={weekdays:"Werkdagen (ma-vr)",monday:"Maandag",tuesday:"Dinsdag",wednesday:"Woensdag",thursday:"Donderdag",friday:"Vrijdag",saturday:"Zaterdag",sunday:"Zondag"},h=t=>{const n={...a};n[t]&&n[t].length>0?n[t]=[]:n[t]=[{opens:"09:00",closes:"17:00"}],m(e,n)},u=t=>{const n={...a};n[t]&&0!==n[t].length&&n[t][0].closed?n[t]=[{opens:"09:00",closes:"17:00"}]:n[t]=[{closed:!0}],m(e,n)},y=(t,n,o)=>{const s={...a};s[t]&&0!==s[t].length||(s[t]=[{opens:"09:00",closes:"17:00"}]),s[t][0][n]=o,m(e,s)},f=(e,t,o=null)=>{const s=a[e]||[],l=s.length>0,r=l?s[0]:{opens:"09:00",closes:"17:00"},d=l&&!0===r.closed,c="weekdays"===e;return(0,i.jsxs)("div",{style:{marginBottom:"12px",padding:"12px",border:o?`2px solid ${o}`:"1px solid #ddd",borderRadius:"4px",background:l?o?"#f0f7ff":"#f9f9f9":"#fff"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:l?"8px":"0"},children:(0,i.jsx)(n.CheckboxControl,{label:t,checked:l,onChange:()=>h(e),__nextHasNoMarginBottom:!0})}),l&&(0,i.jsxs)("div",{style:{paddingLeft:"30px"},children:[!c&&(0,i.jsx)(n.CheckboxControl,{label:"Gesloten",checked:d,onChange:()=>u(e),__nextHasNoMarginBottom:!0}),!d&&(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:c?"0":"8px"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("div",{style:{fontSize:"11px",marginBottom:"4px",color:"#757575"},children:"Van"}),(0,i.jsx)(n.TextControl,{type:"time",value:r.opens||"09:00",onChange:t=>y(e,"opens",t),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("div",{style:{fontSize:"11px",marginBottom:"4px",color:"#757575"},children:"Tot"}),(0,i.jsx)(n.TextControl,{type:"time",value:r.closes||"17:00",onChange:t=>y(e,"closes",t),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]})]})]})]},e)};return(0,i.jsx)(r,{label:t.label,children:(0,i.jsxs)("div",{style:{marginTop:"8px"},children:[f("weekdays",g.weekdays,"#2271b1"),t.description&&(0,i.jsx)("p",{style:l,children:t.description}),p.map(e=>f(e,g[e]))]})},t.meta_key);default:return(0,i.jsxs)(r,{label:t.label,children:[(0,i.jsx)(n.TextControl,{...c,placeholder:t.placeholder,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),t.description&&(0,i.jsx)("p",{style:l,children:t.description})]},t.meta_key)}})(e,t))})}})})();