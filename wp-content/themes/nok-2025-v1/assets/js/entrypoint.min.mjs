import events from"./domule/core.events.mjs";import{loadModules}from"./domule/core.loader.mjs";import{logger,DEBUG}from"./domule/core.log.mjs";import{classToggler}from"./domule/modules/hnl.classtoggler.mjs";import{pageScrollPercentage}from"./domule/util.perf.mjs";import{setupScrollbarControl,setupFakeScrollbar,shuffleChildren}from"./nok-scrollbar.mjs";import{ViewportScroller}from"./domule/util.ensure-visibility.mjs";import AOS from"./nok-aos.mjs";import{singleClick}from"./domule/modules/hnl.clickhandlers.mjs";
const NAME="entryPoint";const BODY=document.body;logger.info(NAME,"Starting up...");window.exports="object"==typeof window.exports?window.exports:{};events.docLoaded(function(){document.body.classList.add("__enable-transitions");events.addListener("scroll",e=>{if(window.scrollY===0){if(DEBUG)logger.log(NAME,"Hash cleared");history.replaceState({},document.title,window.location.pathname+window.location.search)}const scrolled=Math.round(pageScrollPercentage());document.documentElement.style.setProperty("--doc-scrolled",
`${scrolled}%`);document.documentElement.style.setProperty("--doc-scrolled-float",`${scrolled/100}`);document.documentElement.style.setProperty("--scrollbar-width",`${Math.max(0,window.innerWidth-document.documentElement.clientWidth)}px`)})()});events.docReady(function(){classToggler();loadModules(function(e){logger.info(NAME,"Ready.")});document.addEventListener("touchstart",function(){},false);shuffleChildren(document.querySelectorAll("[data-nok-shuffle]"));document.querySelectorAll(".nok-scrollable__horizontal, .nok-scrollable__vertical").forEach(setupFakeScrollbar);
document.querySelectorAll("[data-scroll-target]").forEach(setupScrollbarControl);events.addListener("breakPointChange",e=>{document.querySelectorAll("foreignObject > img").forEach(img=>{img.style.display="none";requestAnimationFrame(()=>{img.style.display="block"})})});const scrollerMap=new WeakMap;const scrollToElement=el=>{if(!el)return;let scroller=scrollerMap.get(el);if(!scroller){scroller=new ViewportScroller(el,{behavior:"smooth",extraOffset:20});scrollerMap.set(el,scroller)}scroller.ensureVisible()};
const scrollToHash=()=>{const id=location.hash.slice(1);const el=id&&document.getElementById(id);scrollToElement(el)};singleClick(document.querySelectorAll('a[href*="#"]'),e=>{const link=e.target;if(!link)return;const url=new URL(link.href,location.href);if(url.hash==="#"||!url.hash){console.log("Should not scroll");e.preventDefault();return}if(url.pathname!==location.pathname)return;const el=document.getElementById(url.hash.slice(1));if(!el)return;e.preventDefault();history.pushState(null,"",url.hash);
scrollToElement(el)});window.addEventListener("popstate",scrollToHash);if(location.hash)scrollToHash();singleClick(document.querySelectorAll(".scroll-to-top"),()=>{window.scrollTo({top:0,behavior:"smooth"})});const aos=AOS.init({selector:"nok-section:not(.no-aos),.nok-aos",duration:600,threshold:.35,once:true})});
