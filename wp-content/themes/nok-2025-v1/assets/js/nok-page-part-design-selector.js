(()=>{"use strict";const t=window.wp.data,e=window.wp.plugins,s=window.wp.editPost,i=window.wp.components,a=new class{constructor(t,e,s,i,a,r){this.startdeg=i||0,this.degsteps=t||60,this.startsat=e||100,this.startbri=s||100,this.gradsteps=a&&a>1?a:10,this.paletlim=r||[0,360],this.skipgreen=!1,this.calls=0,this.color=null,this.deg=0,this.cyc=0,this.bri=100,this.sat=100,this.opa=1}_stringToDegrees(t){let e=[...t].reduce((t,e)=>e.charCodeAt(0)+((t<<5)-t),0);return Math.abs(e)%360}_textContrast(t){return Math.round((299*parseInt(t[0])+587*parseInt(t[1])+114*parseInt(t[2]))/1e3)>125?"rgb(0,0,0)":"rgb(255,255,255)"}_componentToHex(t){var e=t.toString(16);return 1===e.length?"0"+e:e}_rgbToHex(t){return"#"+this._componentToHex(t[0])+this._componentToHex(t[1])+this._componentToHex(t[2])}_hexToRgb(t){return t.match(/\w\w/g).map(t=>+`0x${t}`)}_hexToHSL(t){let e=this._hexToRgb(t),s=e[0]/255,i=e[1]/255,a=e[2]/255,r=Math.min(s,i,a),o=Math.max(s,i,a),n=o-r,h=0,d=0,l=0;return h=0===n?0:o===s?(i-a)/n%6:o===i?(a-s)/n+2:(s-i)/n+4,h=Math.round(60*h),h<0&&(h+=360),l=(o+r)/2,d=0===n?0:n/(1-Math.abs(2*l-1)),d=+(100*d).toFixed(1),l=+(100*l).toFixed(1),[h,d,l]}_hsl2hsv(t){const e=t[1]*(t[2]<50?t[2]:100-t[2])/100,s=0===e?0:2*e/(t[2]+e)*100,i=t[2]+e;return[t[0],s,i]}_HSVtoRGB(t,e,s,i){var a,r,o,n,h,d,l,c;switch(t/=360,e/=100,s/=100,i=void 0!==i?parseFloat(i):void 0,1===arguments.length&&(e=t.s,s=t.v,t=t.h),d=s*(1-e),l=s*(1-(h=6*t-(n=Math.floor(6*t)))*e),c=s*(1-(1-h)*e),n%6){case 0:a=s,r=c,o=d;break;case 1:a=l,r=s,o=d;break;case 2:a=d,r=s,o=c;break;case 3:a=d,r=l,o=s;break;case 4:a=c,r=d,o=s;break;case 5:a=s,r=d,o=l}let g=[Math.round(255*a),Math.round(255*r),Math.round(255*o)],p="rgb";return void 0!==i&&(g.push(i),p="rgba"),{values:g,string:p+"("+g.join(",")+")",hex:this._rgbToHex(g),contra:this._textContrast(g),textContrast:this._textContrast}}doColor(t,e){let s=!1;if("string"==typeof t)if("#"===t[0]){let e=this._hsl2hsv(this._hexToHSL(t));this.deg=e[0],this.sat=e[1],this.bri=e[2],s=!0}else this.deg=this._stringToDegrees(t);else this.startdeg=this.startdeg<this.paletlim[0]?this.paletlim[0]:this.startdeg,this.deg=this.startdeg+this.calls*this.degsteps;if(this.cyc=Math.floor(this.deg/this.paletlim[1]),!s&&(this.bri=t&&t>0?t:this.startbri,this.sat=e&&e>0?e:this.startsat,this.bri=Math.abs(this.bri%101),this.sat=Math.abs(this.sat%101),this.deg=this.deg%(this.paletlim[1]+1),this.deg=this.deg<this.paletlim[0]?this.paletlim[0]:this.deg,this.paletlim[0]%this.degsteps===0&&this.cyc>0)){let s=this.cyc*this.gradsteps;this.altbri=t&&t>0?t:this.startbri-s,this.altsat=e&&e>0?e:this.startsat-s,this.altdeg=this.deg+this.degsteps/(this.cyc+1),this.altdeg=this.altdeg<this.paletlim[0]?this.altdeg-this.paletlim[0]:this.altdeg,this.bri=this.altbri,s>=100&&(this.cyc=0,this.gradsteps=this.gradsteps/2)}return this._HSVtoRGB(this.deg,this.sat,this.bri)}new(t,e){return this.color=this.doColor(t,e),this.string=this.color.string,this.values=this.color.values,this.contra=this.color.contra,this.hex=this._rgbToHex(this.color.values),this.calls++,this}adjust(t){let e,s,i,a,r=void 0!==t.deg?t.deg:0,o=void 0!==t.sat?t.sat:this.sat,n=void 0!==t.bri?t.bri:this.bri,h=void 0!==t.opa?t.opa:this.opa;return i=(this.deg+r)%this.paletlim[1],s=n<=1&&n>0?this.bri*n:n,e=o<=1&&o>0?this.sat*o:o,a=h<0?0:h>1?1:h,s=s>100?100:s<0?0:s,e=e>100?100:e<0?0:e,this._HSVtoRGB(i,e,s,a)}},r=window.location.search.includes("debug=true");const o="font-family: Lucida Grande,Lucida Sans Unicode,Lucida Sans,Geneva,Verdana,sans-serif";const n=function(t,e){!r||console.log("object"==typeof t?t:function(t){return"%c"+[].slice.call(t).join("%c")}("object"==typeof e?[t]:arguments),`${o}; ${function(t){const e=a.new(t);return`color:${e.contra};\n  background-color:${e.string};\n  background-image:linear-gradient(0deg,${e.adjust({deg:10}).string} 0%, ${e.adjust({opa:1}).string} 100%);\n  padding:3px 5px;margin-right:15px;border-radius:4px;`}(t)}`,"object"==typeof e?e:`${o};color:black;`)},h=window.ReactJSXRuntime,d="nok-page-part-design-selector";(0,e.registerPlugin)("page-part-design",{render:function(){if("page_part"!==(0,t.useSelect)(t=>t("core/editor").getCurrentPostType(),[]))return null;const e=(0,t.useSelect)(t=>t("core/editor").getCurrentPostId(),[]),a=(0,t.useSelect)(t=>t("core/editor").getEditedPostAttribute("meta"),[]),{editPost:r}=(0,t.useDispatch)("core/editor"),o=window.PagePartDesignSettings?.registry||{},l=[{label:"— Select —",value:""},...Object.entries(o).map(([t,e])=>({label:e.name,value:t}))];return n(d,"DesignSlugPanel meta:"),n(d,a),(0,h.jsx)(s.PluginDocumentSettingPanel,{name:"page-part-design",title:"Design template",children:(0,h.jsx)(i.SelectControl,{value:a?.design_slug||"",options:l,onChange:t=>{n(d,`→ setting design_slug to "${t}"`),r({meta:{...a,design_slug:t}}),(t=>{fetch(window.PagePartDesignSettings.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"store_preview_meta",post_id:e,design_slug:t})}).then(t=>t.json()).then(t=>(n(d,"Meta stored via React:"),n(d,t),wp.data.dispatch("core/editor").autosave())).then(()=>{n(d,"Autosave completed via React");const t=document.getElementById("nok-page-part-preview-iframe");if(t){const e=wp.data.select("core/editor").getEditedPostPreviewLink();t.removeAttribute("srcdoc"),t.src=`${e}&hide_adminbar=1`}})})(t)}})})}})})();